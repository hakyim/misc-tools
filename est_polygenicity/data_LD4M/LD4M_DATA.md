# About

To apply S-LD4M, we need to pre-compute the 4th moment of LD between SNPs.
Following the readme in [SLD4M repo](), we can download the pre-computed l2l4 scores from [this dropbox link](https://www.dropbox.com/sh/iiyftw01gdpt6un/AACU7AmWK45RxTmDJvRkdKhIa?dl=0).

Unfortunately, these files are not well documented. 
But from the filename, our best guess is that they were calculated using 1000G genotypes.
Note that this is different from what is being showed in [their paper](https://www.sciencedirect.com/science/article/pii/S0002929719302666), in which the scores were obtained from UK10K cohort.
And it's likely that the reason why not sharing the original scores is due to the restriction of UK10K (just like the baselineLF model [paper](https://www.nature.com/articles/s41588-018-0231-8)). 

Since these scores play a huge role in the LD4M result, we document a bit on our current understanding of the pre-computed scores.

# Look into the l2l4 SNPs

In `data_explore.R`, we have a reproducible script to analyze the relation among l2l4 SNPs, 1000G SNPs, and UK10K SNPs.
Here we define "common SNPs" are the ones with MAF > 0.05 in the corresponding dataset.
A short take-away is as follow:

```
Count of common SNPs 
UK10K = 5353593
l2l4 (maf_bin) = 4812921
l2l4 (base) = 5916539
1000G = 5961159
l2l4 = 6227113   
```

1. l2l4 maf_bin is a subset of UK10K common SNPs.
2. l2l4 non-maf_bin is almost not common in UK10K.
3. |l2l4 maf_bin| = 4812921; |UK10K common| = 5353593.
4. Aggregate the results from the non-overlapping l2l4 maf_bin bins. It may be slightly smaller than the one from UK10K common since it contains fewer SNPs.

Here `maf_bin` refers to the 60-69 non-overlapping annotations: MAFbin1 - MAFbin10.

So, from the relation above, we should use the aggregation of these MAF bins as a proxy of the common SNPs.
This is implemented in `../scripts/run_sld4m.m` as "Manual_aggregated" annotation as part of the output.   

The full log of `data_explore.R` is at `data_explore.log` (generated by running `Rscript data_explore.R > data_explore.log 2>&1`).
